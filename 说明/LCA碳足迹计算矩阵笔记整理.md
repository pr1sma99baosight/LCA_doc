# LCA碳足迹计算笔记整理

## 基本逻辑

根据湛江LCA报告，生命周期排放 = 直接排放 + 各次间接排放。公式如下：
$$
b_{T,F,g}=b_{F,g}+\sum a_{T,i}b_{i,g}
$$
其中

* $$b_{T,F,g}$$为直接排放矩阵
* $$a_{T,i}$$为消耗量矩阵
* $$b_{i,g}$$为排放系数矩阵

### 建模过程

投入产出矩阵D：

<img src="/Users/peterwang/Library/Application Support/typora-user-images/image-20230913162920855.png" alt="image-20230913162920855" style="zoom:55%;" />

单元过程之间的直接消耗系数矩阵A：

<img src="/Users/peterwang/Library/Application Support/typora-user-images/image-20230913162940120.png" alt="image-20230913162940120" style="zoom:60%;" />

单元过程之间的完全消耗系数矩阵B：
$$
B=(I-A)^{-1}
$$
完全消耗矩阵公式来源于Leontief开放模型。

### Leontief模型

Leontief模型被大量应用于投入产出分析当中，其原理上将经济生产划分为多个部门，其中每个部门不仅为自身生产商品和服务，还为其他部门生产，因此存在相互依赖关系。当应用于本次LCA分析时，各部门相当于能源和钢铁生产中的各道工序。Leontief模型分为封闭式和开放式，封闭模型中总投入等于总产出，即所有产品都被各道工序内部消耗，而开放模型中产品除了自身消耗还会有额外产出，即来自消费者的需求，因此应当采用开放式模型进行LCA计算。

### 开放模型

以下内容翻译自：[Applications – Leontief Models](https://math.libretexts.org/Bookshelves/Applied_Mathematics/Applied_Finite_Mathematics_(Sekhon_and_Bloom)/02%3A_Matrices/2.06%3A_Applications__Leontief_Models)

开放模型更为现实，因为它处理的是一个经济体，其中经济部门不仅能够满足彼此的需求，还能满足一些外部需求。在这种情况下，外部需求是由消费者提出的。但基本假设仍然是相同的；那就是，所产生的一切都被消耗掉了。

假设经济体由三个人组成，农民F、木匠C和裁缝T。农民的一部分产量被三人共同使用，其余部分则被消费者使用。同样，木匠和裁缝的一部分产量也被三人共同使用，其余部分则被消费者使用。

假设农民所生产的一切中，有20%被他自己使用，15%被木匠使用，10%被裁缝使用，而消费者则使用其余价值400亿美元的食物。木匠自身使用他产出的10%，农民使用25%，裁缝使用5%，消费者则使用价值500亿美元的部分。裁缝使用他所制造的衣服的15%，农民使用10%，木匠使用5%，而剩余价值600亿美元的部分则被消费者使用。我们将内部消费写在下面的表格中，并将需求表示为矩阵D。

|        | F 生产 | C 生产 | T 生产 |
| ------ | ------ | ------ | ------ |
| F 使用 | .20    | .25    | .10    |
| C 使用 | .15    | .10    | .05    |
| T 使用 | .10    | .05    | .15    |

消费者需求（单位：十亿美元）如下：
$$
D = \begin{bmatrix} 40 \\ 50 \\ 60 \end{bmatrix}
$$
在上述例子中，以十亿美元为单位，每个行业应该达到多少产出才能满足矩阵𝐷给出的需求？

我们选择以下变量。

* x = 农民的产出

* y = 木匠的产出

* z = 裁缝的产出

在封闭模型中，我们的方程是 𝑋 = 𝐴𝑋 ，即总投入等于总产出。这次我们的方程与封闭模型类似，只是需要考虑消费者的需求。

所以我们的开放模型方程应该是 𝑋 = 𝐴𝑋 + 𝐷 ，其中 𝐷 代表需求矩阵。

公式如下：
$$
\begin{bmatrix} x \\ y \\ z \end{bmatrix} =\begin{bmatrix} .20 & .25 & .10 \\ .15 & .10 & .05 \\ .10 & .05 & .15 \end{bmatrix} \begin{bmatrix} x \\ y \\ z \end{bmatrix} + \begin{bmatrix} 40 \\ 50 \\ 60 \end{bmatrix}
$$
计算过程如下：
$$
X = AX + D \\
(I - A)X = D \\
X = (I-A)^{-1}D
$$
其中，$$I$$为3x3的单位矩阵，主对角线为1，其余各项为0。
$$
I−A=\begin{bmatrix} .80 & -.25 & -.10 \\ -.15 & .90 & -.05 \\ -.10 & -.05 & .85 \end{bmatrix} 
$$

$$
(I−A)^{-1}=\begin{bmatrix} 1.3445 & .3835 & .1807 \\.2336  & 1.1814  & .097 \\ .1719 &  .1146  & 1.2034 \end{bmatrix}
$$

$$
X=\begin{bmatrix} 1.3445 & .3835 & .1807 \\.2336  & 1.1814  & .097 \\ .1719 &  .1146  & 1.2034 \end{bmatrix}\begin{bmatrix} 40 \\ 50 \\ 60 \end{bmatrix}
$$

$$
X=\begin{bmatrix} 83.7999 \\ 74.2341 \\ 84.8138 \end{bmatrix}
$$

这三个行业必须产生以下金额的商品，单位为十亿美元。

农民 = \$83.7999，木匠 = \$74.2341，裁缝 = \$84.813。

总结：
$$
𝑋=𝐴𝑋+𝐷
  
$$

$$
𝑋=(𝐼−𝐴)^{−1}𝐷
$$

当$$D$$为单位矩阵时，$$X$$则变为生产单位产品所产生的负荷，即上文中提到的完全消耗系数。
$$
B=(I-A)^{-1}
$$

## 中间结果分布说明

### 中间结果输出数据type含义说明

| Type | 类型             | 说明                                                         |
| ---- | ---------------- | ------------------------------------------------------------ |
| 1    | 主工序直接负荷   | 主工序消耗物料产生的直接排放计入此处，比如在主工序消耗天然气，煤、煤气，由天然气、煤、煤气燃烧产生的负荷。 |
| 2    | 主工序回用负荷   | 主工序使用其他工序的副产品（即内部回用的副产品）时对应的负荷计入此处，如渣钢、渣铁。 |
| 3    | 主工序外部负荷   | 主工序消耗的外购物料对应的负荷计入此处。此负荷为外购物料在工厂边界外生产对应的负荷。如外购合金、矿石。 |
| 4    | 主工序内部收益   | 主工序产出的副产品在厂内回用抵扣的负荷计入此处，如渣钢、渣铁、TRT电、回收低压蒸汽。 |
| 5    | 主工序外部收益   | 主工序产出的副产品外卖至其他厂家抵扣的负荷计入此处，如干渣、水渣。 |
| 6    | 能辅产品直接负荷 | 厂内生产能辅产品时产生的直接排放计入此处，比如厂内生产生石灰时，消耗石灰石产生的直接排放；燃煤发电时煤燃烧的直接排放。 |
| 7    | 能辅产品回用负荷 | 厂内生产能辅产品时使用其他工序的副产品（即内部回用的副产品）对应的负荷计入此处，如回收低压蒸汽、输出混合电中使用了TRT电。 |
| 8    | 能辅产品外部负荷 | 厂内生产能辅产品时消耗的外购物料对应的负荷计入此处。此负荷为外购物料在工厂边界外生产对应的负荷。如外购的动力煤。 |
| 9    | 能辅产品内部收益 | 厂内生产能辅产品时产出的副产品在厂内回用抵扣的负荷计入此处，如回收低压蒸汽。 |
| 10   | 能辅产品外部收益 | 厂内生产能辅产品时产出的副产品外卖至其他厂家抵扣的负荷计入此处，如石灰石细粉（如果外售）。 |
| 11   | 外部运输负荷     | 所有外购物料从上游厂家运输至厂内对应的外部运输负荷计入此处。 |

1. 主工序为和钢铁产品直接相关并且前后串联的工序，通常情况下，焦化、烧结、球团至高炉、转炉至后续连铸、热轧、冷轧等工序都是主工序。
2. 能辅工序为和钢铁产品并非直接相关的工序，其产品在一条生产线上可能被多个主工序使用，比如CCPP电、燃煤电、混合电、工业水、除盐水、低压蒸汽、高炉鼓风。
3. 能辅工序的一个特点为其产品容易出现互相调用的情况，比如生产工业水时使用了电力（电力构成中含CCPP电），生产CCPP电时又使用了工业水。相反，主工序不存在产品互相调用的情况，即不会出现生产热轧卷时使用了连铸坯，生产连铸坯的时候使用了热轧卷。
4. 厂内运输通过数据项“柴油”体现，各个工序中柴油的总负荷即为分摊至该工序的运输负荷。

### 	中间结果同产品G1~G7对应关系说明

| 类型 | 名称           | 说明                                                         |
| ---- | -------------- | ------------------------------------------------------------ |
| G1   | 直接负荷       | 生产该产品**最后一道**工序消耗物料产生的直接排放计入此处。   |
| G2   | 能源负荷       | 生产该产品**所有**工序消耗的**能辅产品**对应的、生产这些能辅产品的直接排放计入此处。 |
| G3   | 中间产品负荷   | 生产该产品**除最后一道工序**的**主工序**消耗物料产生的直接排放，以及含主工序、能辅工序的所有工序产出的**副产品在厂内回用**抵扣的负荷计入此处。 |
| G4   | 副产品内部收益 | 生产该产品**所有工序**产出的副产品在厂内回用抵扣的负荷计入此处。 |
| G5   | 运输负荷       | 所有外购物料从上游厂家运输至厂内对应的外部运输负荷计入此处。 |
| G6   | 上游负荷       | **所有工序**消耗的外购物料对应的负荷计入此处。此负荷为外购物料在工厂边界外生产对应的负荷。 |
| G7   | 副产品外部收益 | 生产该产品**所有工序**产出的副产品外卖至其他厂家抵扣的负荷计入此处。 |

注：产品G1~G7的分析维度不考虑其生产过程的碳负荷分布，其G2~G7为该产品所有生产工序对应负荷的累计值。

**type1~11**同**G1~G7**对应关系

1. G1=最后一道工序Type1
2. G2=Type6
3. G3=Type1（不含最后一道工序）+Type2+Type7
4. G4=Type4+Type9
5. G5=Type11
6. G6=Type3+Type8
7. G7=Type5+Type10

注：Type2为所有工序Type2的数据项对应负荷的合计值（Type3~Type11同理）。

### 计算公式

LCA数据模型核对

| **矩阵** | **名称**                                                     | **公式**                                                     |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| G1       | 工序直接负荷                                                 |                                                              |
| G2       | 自产能源带入负荷                                             | $$PE_2[PA_2\cdot (I-PA_1)^{-1}] +GAS_{up}[GAS\cdot (I-PA_1)^{-1}]$$ |
| PA1      | 本工序的原材料、辅料来自其他主工序的产品                     |                                                              |
| PA2      | 本主工序的能源来自其他能源工序的产品                         |                                                              |
| PE2      | 能源site（不包含发电工序\一二三四鼓风）                      |                                                              |
| GASup    | 上游产品消耗因子（0014）：焦炉煤气，高炉煤气，转炉煤气       |                                                              |
| GAS      | 基础数据表：焦炉煤气，高炉煤气，转炉煤气                     |                                                              |
| G3       | 中间产品带入负荷                                             | $$G_1[(I-PA_1)^{-1}-I]$$                                     |
| G4       | 副产品内部循环收益                                           | $$RG[RA\cdot (I-PA_1)^{-1}]$$                                |
| RG       | 维护表（UP表中读取）                                         |                                                              |
| RA       | 该工序产出的副产品（无论是否在其他工序有产品产出）在其他工序有使用，将该工序的副产品单耗列出 |                                                              |
| G5       | 运输负荷                                                     | $$T\cdot L\cdot [OA\cdot (I-PA_1)^{-1}]+PF_2[PA_2\cdot (I-PA_1)^{-1}]$$ |
| T        | 运输LCA基础数据维护表（0010）                                |                                                              |
| L        | 运输距离维护表(0011)                                         |                                                              |
| OA       | 大宗原材料的运输                                             |                                                              |
| PF2      |                                                              | sa_lca_ny_g5                                                 |
| G6       | 上游负荷                                                     | $$OG[OA_1\cdot (I-PA_1)^{-1}]+PG_2 [PA_2\cdot (I-PA_1)^{-1}]$$ |
| OG       | 维护表（UP表中读取0014）OG顺序要与OA1对应                    |                                                              |
| OA1      | 各工序对外购产品的直接消耗系数矩阵，即工序中消耗量，不算输出量，所有外购（不是其他工序的产品） |                                                              |
| PG2      | 能源G6                                                       |                                                              |
| G7       | 副产品外部循环收益                                           | $$RG_1[RA_1(I-PA_1)^{-1}]+PH_2[PA_2(I-PA_1)^{-1}]$$          |
| RG1      | 维护表（根据RA1中数据到UP表中读取                            |                                                              |
| RA1      | 卖到外面的副产品（产出的副产品没有在任何工序中作为投入）     |                                                              |
| PH2      | 能源G7                                                       |                                                              |
| gsite    | 内部合计                                                     | $$g1+g2+g3-g4$$                                              |
| groute   | 生命周期                                                     | $$g1+g2+g3-g4+g5+g6-g7$$                                     |
| goutsite | 外部合计                                                     | $$g5+g6-g7$$                                                 |

此处不包含能源生产中所产生的负荷，即能源G1-G7。能源负荷的计算包含在2019表中。

矩阵2019

| **矩阵** | **名称**                             | **公式**                       |
| -------- | ------------------------------------ | ------------------------------ |
| 能源G1   | 能源系统直接负荷                     | $$g_1$$                        |
| 能源G2   | 能源生产中消耗能辅产品带入负荷       | $$g_2 = g_1[(I-PB_2)^{-1}-I]$$ |
| PB2      | 能源产品对自产能源的直接消耗系数矩阵 |                                |
| PA2      | 本主工序的能源来自其他能源工序的产品 |                                |

**问题：**在数据模型中副产品的抵扣收益是从总体负荷中减去的，即$$g_{site} = g1+g2+g3-g4$$，$$g_{outsite} = g5+g6-g7$$，$$g_{route} = g1+g2+g3-g4+g5+g6-g7$$，而2019表中是累加关系$$g_{route} = g1+g2+g3+g4+g5+g6+g7$$。可能会对计算规则产生影响。
